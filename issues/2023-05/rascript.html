<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta content="width=device-width" name="viewport">
  <!-- <title>RAScript Tutorials</title> -->
  <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>RAScript Tutorials | RANews</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="RAScript Tutorials" />
<meta name="author" content="Etron" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Tutorial #12 – Leaderboards" />
<meta property="og:description" content="Tutorial #12 – Leaderboards" />
<link rel="canonical" href="https://news.retroachievements.org/issues/2023-05/rascript.html" />
<meta property="og:url" content="https://news.retroachievements.org/issues/2023-05/rascript.html" />
<meta property="og:site_name" content="RANews" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-09-04T22:30:02+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="RAScript Tutorials" />
<script type="application/ld+json">
{"author":{"@type":"Person","name":"Etron"},"headline":"RAScript Tutorials","dateModified":"2025-09-04T22:30:02+00:00","datePublished":"2025-09-04T22:30:02+00:00","description":"Tutorial #12 – Leaderboards","url":"https://news.retroachievements.org/issues/2023-05/rascript.html","mainEntityOfPage":{"@type":"WebPage","@id":"https://news.retroachievements.org/issues/2023-05/rascript.html"},"@type":"BlogPosting","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

  <link type="application/atom+xml" rel="alternate" href="https://news.retroachievements.org/feed.xml" title="RANews" />

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-177315439-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'UA-177315439-1');
  </script>

  <link href="https://use.fontawesome.com/releases/v5.12.0/css/all.css" rel="stylesheet">
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:ital,wght@0,400;0,700;1,400;1,700&display=swap"
    rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Play:wght@700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/css/normalize.css">
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/css/rafont.css">
  <link rel="shortcut icon" type="image/png"
    href="/img/retroachievements-logo-color-transparent-square.png" sizes="16x16 32x32 64x64">
</head>

<body>

  <div class="grid">
    <aside>
  <div class="sidebar-header">
    <a href="https://news.retroachievements.org">
      <img alt="" src="/img/ranews-small.png">
    </a>
  </div>
  <div class="article-list-container">
    <h2>2023-05</h2>

    <label for="article-list-toggle">&#9776;</label>
    <input id="article-list-toggle" type="checkbox"/>

    <ul class="article-list">
      
      
        
          

          
            <a href="/issues/2023-05/index.html">
              <li>Introduction</li>
            </a>
          
        
      
        
          

          
            <a href="/issues/2023-05/set-of-the-month.html">
              <li>Set of the Month</li>
            </a>
          
        
      
        
          

          
            <a href="/issues/2023-05/this-month-in-retro.html">
              <li>This Month In Retro</li>
            </a>
          
        
      
        
          

          
            <a href="/issues/2023-05/monthly-stats.html">
              <li>Monthly Stats</li>
            </a>
          
        
      
        
          

          
            <a href="/issues/2023-05/milestones.html">
              <li>Milestones</li>
            </a>
          
        
      
        
          

          
            <a href="/issues/2023-05/current-events.html">
              <li>Current Events</li>
            </a>
          
        
      
        
          

          
            <a href="/issues/2023-05/community-news.html">
              <li>Community News</li>
            </a>
          
        
      
        
          

          
            <a href="/issues/2023-05/rapodcast.html">
              <li>RAPodcast</li>
            </a>
          
        
      
        
          

          
            <li class="active">RAScript Tutorials</li>
          
        
      
        
          

          
            <a href="/issues/2023-05/play-this-set.html">
              <li>Play This Set</li>
            </a>
          
        
      
        
          

          
            <a href="/issues/2023-05/wish-this-set.html">
              <li>Wish This Set</li>
            </a>
          
        
      
        
          

          
            <a href="/issues/2023-05/raguide.html">
              <li>RAGuide</li>
            </a>
          
        
      
        
          

          
            <a href="/issues/2023-05/radvantage.html">
              <li>RAdvantage</li>
            </a>
          
        
      
        
          

          
            <a href="/issues/2023-05/hot-cheevs.html">
              <li>HotCheevs Monthly</li>
            </a>
          
        
      
        
          

          
            <a href="/issues/2023-05/revisions-and-rescores.html">
              <li>Revisions and Rescores</li>
            </a>
          
        
      
        
          

          
            <a href="/issues/2023-05/art-updates.html">
              <li>Art Updates</li>
            </a>
          
        
      
        
          

          
            <a href="/issues/2023-05/top-players.html">
              <li>Top Players</li>
            </a>
          
        
      
        
          

          
            <a href="/issues/2023-05/ranniversaries.html">
              <li>RAnniversaries</li>
            </a>
          
        
      
        
          

          
            <a href="/issues/2023-05/top-masteries.html">
              <li>Top Masteries</li>
            </a>
          
        
      
        
          

          
            <a href="/issues/2023-05/most-wanted.html">
              <li>Most Wanted Games</li>
            </a>
          
        
      
        
          

          
            <a href="/issues/2023-05/set-creation-leaderboard.html">
              <li>Set Creation Leaderboard</li>
            </a>
          
        
      
        
          

          
            <a href="/issues/2023-05/spot-the-difference.html">
              <li>Spot The Difference</li>
            </a>
          
        
      
    </ul>
  </div>
  <div class="footer">
    <ul class="icons">
      <li>
        <a href="https://retroachievements.org/">
          <i class="icon icon-retroachievements"></i>
        </a>
      </li>
      <li>
        <a href="https://discord.gg/dq2E4hE">
          <i class="fab fa-discord"></i>
        </a>
      </li>
      <li>
        <a href="https://docs.retroachievements.org/">
          <i class="fa fa-book"></i>
        </a>
      </li>
      <li>
        <a href="https://github.com/RetroAchievements">
          <i class="fab fa-github"></i>
        </a>
      </li>
    </ul>
  </div>
</aside>

    <main>
      <header>
        <nav>
  
    <a href="/issues/2023-05/rapodcast.html" class="previous">
      &#x00ab
      
        RAPodcast
      
    </a>
  
  
    <a href="/issues/2023-05/play-this-set.html" class="next">
      
        Play This Set
      
      &#x00bb
    </a>
  
</nav>
      </header>
      <article>
        <header>
          
          <h1 id="top">RAScript Tutorials</h1>
          

          
          
          <div class="author">
            
              
              
              
              <img src="https://retroachievements.org/UserPic/Etron.png" alt="Etron">
            
            <span>By 
              
                
                
                <a href="https://retroachievements.org/user/Etron">Etron</a>
              
            </span>
          </div>
          
        </header>

        
        <div id="toc" class="toc-container ">
          <p class="toc-title">Contents</p>
          <ul>
  <li><a href="#tutorial-12--leaderboards">Tutorial #12 – Leaderboards</a>
    <ul>
      <li><a href="#overview">Overview</a></li>
      <li><a href="#leaderboards">Leaderboards</a></li>
      <li><a href="#game-events">Game Events</a></li>
      <li><a href="#start-event">Start Event</a></li>
      <li><a href="#cancel-event">Cancel Event</a></li>
      <li><a href="#submit-event">Submit Event</a></li>
      <li><a href="#leaderboard-value">Leaderboard Value</a></li>
      <li><a href="#lower-is-better">Lower is Better?</a></li>
      <li><a href="#format">Format</a></li>
    </ul>
  </li>
  <li><a href="#example-12a-level-speedruns">Example #12A: Level Speedruns</a></li>
  <li><a href="#one-logic-to-rule-them-all">One Logic to Rule Them All</a>
    <ul>
      <li><a href="#start-event-1">Start Event</a></li>
      <li><a href="#cancel-event-1">Cancel Event</a></li>
      <li><a href="#submit-event-1">Submit Event</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#lower-is-better-1">Lower is Better?</a></li>
      <li><a href="#format-1">Format</a>
        <ul>
          <li><a href="#script">Script</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="#example-12b-kill-count">Example #12B: Kill Count</a>
    <ul>
      <li><a href="#counting-game-actions">Counting Game Actions</a></li>
      <li><a href="#start-event-2">Start Event</a></li>
      <li><a href="#cancel-event-2">Cancel Event</a></li>
      <li><a href="#submit-event-2">Submit Event</a></li>
      <li><a href="#value-1">Value</a></li>
      <li><a href="#lower-is-better-2">Lower is Better?</a></li>
      <li><a href="#format-2">Format</a>
        <ul>
          <li><a href="#script-1">Script</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="#example-12c-game-speedruns">Example #12C: Game Speedruns</a></li>
  <li><a href="#homework-12">Homework #12</a>
    <ul>
      <li><a href="#useful-memory">Useful Memory</a>
        <ul>
          <li><a href="#solution">Solution</a></li>
        </ul>
      </li>
    </ul>
  </li>
</ul>
        </div>
        

        <h1 id="tutorial-12--leaderboards">Tutorial #12 – Leaderboards</h1>

<h2 id="overview">Overview</h2>
<p>This tutorial will show a few examples of making leaderboards for the game <a href="https://retroachievements.org/game/11256">Doom</a>. Doom is an extremely popular first person shooter that was ported to many systems and still has the strong fan base to this day.  The main reason why Doom was selected for this tutorial is that it was one of the first games to have speedrun competitions.   Doom can record gameplay from user inputs making a small file that can be replayed on any computer with Doom installed.  This prompted players to record how quickly they could finish a level and upload the recording to compare with other players.  Eventually, various categories of Doom speedruns were defined and the speedrun community grew and expanded to other games.<br /></p>

<p align="center">
  <img src="https://github.com/Etron-RA/RetroAchievements/blob/main/Tutorials/12_Leaderboards/Doom_Title.png?raw=true" />
</p>

<h2 id="leaderboards">Leaderboards</h2>
<p>Leaderboards are a ranked global list of players and game statistics.  Leaderboards can be based on internal game memory or condition hit counts.  There are many types of leaderboards already on RetroAchievements and some the most common are:</p>
<ul>
  <li>Speedruns – Fastest time to complete an objective (level speedrun Example #12A and game speedrun Example #12C)</li>
  <li>Score Attack – Highest score achieved</li>
  <li>Action Count – How many times a player performs a certain action (kill count Example #12B)</li>
</ul>

<h2 id="game-events">Game Events</h2>
<p>Game events are a group of conditions used to determine when an important event occurs in the game.  It works best if game events have a delta check in them so that they only occur for one frame. The best way to build conditions for a game event is to create a series of test achievements for each game event you are interested in using, activate all the test achievements, check the box “Keep Active” to test for achievements that trigger more than expected, then play through the game normally while noting when achievements trigger.  Common game events include:</p>
<ul>
  <li>Start Game</li>
  <li>Beat Game</li>
  <li>Start Level</li>
  <li>Beat Level</li>
  <li>On Title Screen</li>
  <li>Demo Mode</li>
  <li>Game Over</li>
  <li>Continue Used</li>
  <li>Lost Life</li>
  <li>Lost Health</li>
</ul>

<h2 id="start-event">Start Event</h2>
<p>The start event is a group of conditions used to prime a leaderboard.  Once the leaderboard is primed the user will be notified and the value of the leaderboard will be displayed. Multiple start events can be defined by putting each event into separate alts.</p>

<h2 id="cancel-event">Cancel Event</h2>
<p>The cancel event is a group of conditions used to stop a primed leaderboard.  When a leaderboard is canceled the value is not submitted and the player is notified that they failed the leaderboard. Multiple cancel events can be defined by putting each event into separate alts.</p>

<h2 id="submit-event">Submit Event</h2>
<p>The cancel event is a group of conditions used to submit the value of a primed leaderboard.  When a leaderboard is submitted the value is recorded to the site and the player is notified that they completed the leaderboard. Multiple submit events can be defined by putting each event into separate alts.</p>

<h2 id="leaderboard-value">Leaderboard Value</h2>
<p>The leaderboard value is what gets submitted to the website when successfully completing a leaderboard.  The value can be an internal memory, a combination of memory values (ie. score memory is BCD and needs to be converted to a decimal value), or a count of hits.  If it can be measured then it can be used as a valued board value.</p>

<h2 id="lower-is-better">Lower is Better?</h2>
<p>The <code class="language-plaintext highlighter-rouge">lower_is_better</code> setting effects how the leaderboards is sorted.  If true then the leaderboard will be sorted by putting the player with the lowest score in the #1 ranking.  If false then the leaderboard will be sorted by putting the player with the highest score in the #1 ranking.  If you accidently set <code class="language-plaintext highlighter-rouge">lower_is_better</code> to the wrong value then you can change it later and the leaderboard will resort the entries accordingly.</p>

<h2 id="format">Format</h2>
<p>The format setting only effects how the value is displayed and not the base value submitted. If you accidently set the <code class="language-plaintext highlighter-rouge">format</code> to the wrong value then you can change it later and the leaderboard will displayed with the new <code class="language-plaintext highlighter-rouge">format</code>.  See the <a href="https://github.com/Jamiras/RATools/wiki/Leaderboard-Functions">RATools Wiki</a> for a list of possible formats.</p>

<h1 id="example-12a-level-speedruns">Example #12A: Level Speedruns</h1>

<p>Speedruns are a measure of how long it takes a player to accomplish a goal.  Most speedruns are for accomplishing a goal as quickly as possible however speedruns can have additional conditions that stipulate the difficulty level, collecting all the items, or other handicaps.  If the game is popular enough then it will have various types of speedruns listed on <a href="https://www.speedrun.com/">Speedrun.com</a>.  If the game isn’t listed feel free to come up with your own challenges. For the speedruns in this example the player must be on the difficulty Hurt Me Plenty (difficulty 2 of 4) or higher for the leaderboard to activate.  It is best practice to have some leaderboards that are active for the default settings before adding more complicated leaderboards.<br /></p>

<p align="center">
  <img src="https://github.com/Etron-RA/RetroAchievements/blob/main/Tutorials/12_Leaderboards/Doom_Level_1.png?raw=true" />
</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>// Doom
// #ID = 11256

// $077E10: Map ID 1
//          00 = Main Menu
function MapId() =&gt; byte(0x077E10)

MapLookup = {
    0x0: "Main Menu",
    0x1: "Hangar",
    0x2: "Plant",
    0x3: "Toxin Refinery",
    0x4: "Command Control",
    0x5: "Phobos Lab",
    0x6: "Central Processing",
    0x7: "Computer Station",
    0x8: "Phobos Anomaly",
    0x9: "Deimos Anomaly",
    0xA: "Containment Area",
    0xB: "Refinery",
    0xC: "Deimos Lab",
    0xD: "Command Center",
    0xE: "Halls of the Damned",
    0xF: "Spawning Vats",
    0x10: "Hell Gate",
    0x11: "Hell Keep",
    0x12: "Pandemonium",
    0x13: "House of Pain",
    0x14: "Unholy Cathedral",
    0x15: "Mt. Erebus",
    0x16: "Limbo",
    0x17: "Tower of Babel",
    0x18: "Hell Beneath",
    0x19: "Perfect Hatred",
    0x1A: "Sever the Wicked",
    0x1B: "Unruly Evil",
    0x1C: "Unto the Cruel",
    0x1D: "Twilight Descends",
    0x1E: "Threshold of Pain",
    0x1F: "Entryway",
    0x20: "Underhalls",
    0x21: "The Gantlet",
    0x22: "The Focus",
    0x23: "The Waste Tunnels",
    0x24: "The Crusher",
    0x25: "Dead Simple",
    0x26: "Tricks and Traps",
    0x27: "The Pit",
    0x28: "Refueling Base",
    0x29: "O of Destruction!",
    0x2A: "The Factory",
    0x2B: "The Inmost Dens",
    0x2C: "Suburbs",
    0x2D: "Tenements",
    0x2E: "The Courtyard",
    0x2F: "The Citadel",
    0x30: "Nirvana",
    0x31: "The Catacombs",
    0x32: "Barrels of Fun",
    0x33: "Bloodfalls",
    0x34: "The Abandoned Mines",
    0x35: "Monster Condo",
    0x36: "Redemption Denied",
    0x37: "Fortress of Mistery",
    0x38: "The Military Base",
    0x39: "The Marshes",
    0x3A: "The Mansion",
    0x3B: "Club Doom",
}

// $077dc8: Results Screen
//          01 = Activated (Also at Main Menu)
function ResultScreen() =&gt; byte(0x077dc8)

// $07814C: Game Timer 32-bit
//          (Reset to 0 when the game load a level)
function GameTimer() =&gt; dword(0x07814C)

// $078258: Current Difficulty
function Difficulty() =&gt; byte(0x078258)

// $08656A: Loading...
//          10= On screen
function Loading() =&gt; byte(0x08656A)

// $09874d: Intermission Screen Background
//          01 = Activated
function IntermissionScreen() =&gt; byte(0x09874d)

// $098740: Last HUD Text ID (16-bit)
//          10b0 = All powerful mode on
//          10e0= Lots of goodies!
//          52c= You got the BFG9000!  Oh, yes.
//          5bc= You got the shotgun!
//          5d4= You got the supershotgun!
//          54c= You got the chaingun!
//          564= A chainsaw! Find some meat!
//          584= You got the rocket launcher!
//          5a4= You got the plasma gun!
function LastHudText() =&gt; word(0x098740)

// $098744: HUD Text Timer in screen
function HudTextTimerInScreen() =&gt; byte(0x098744)

// $0A88AC: Cheats
//          Bit1= God Mode
//          Bit2= Full Map
//          Bit3= Show All Things on the Map
//          Bit5= Level Warping
//          Bit7= Invisible Walls
function Cheats() =&gt; byte(0x0A88AC)

/// Helper Functions ////////////////////////////////////////////////////////////

// Start when mapid = current map, no intermission or load screen, 
// on Hurt me Plenty difficulty or higher, and the game timer has started
function StartMap(map)
{
    return MapId() == map &amp;&amp;
        Difficulty() &gt;= 2 &amp;&amp;
        ResultScreen() == 0 &amp;&amp;
        IntermissionScreen() == 0 &amp;&amp;
        prev(GameTimer()) == 0 &amp;&amp; 
        GameTimer() == 2
}

// End when mapid = current map and the results screen is shown
function EndMap(map)
{
    return MapId() == map &amp;&amp;
        prev(ResultScreen()) == 0 &amp;&amp; 
        ResultScreen() == 1
}

// Cancel when the loading screen appears
function LoadScreen() =&gt; IntermissionScreen() == 1 &amp;&amp; Loading() == 0x10

// Cancel when the loading screen appears, or any cheat are used
function GoodiesCheat() =&gt; HudTextTimerInScreen() == 1 &amp;&amp; LastHudText() == 0x0010e0
function CheatsBitflags() =&gt; Cheats() != 0

/// Leaderboards ////////////////////////////////////////////////////////////

// Create a leaderboard for each map
for index in range(0x1, 0x3B)
{    
    leaderboard
    (
       MapLookup[index] + " Speedrun",
       "Fastest time to complete " + MapLookup[index] + " on Hurt Me Plenty or above",
       StartMap(index),
       LoadScreen()  || GoodiesCheat() || CheatsBitflags(),
       EndMap(index),
       always_true(),
       format = "FRAMES",
       lower_is_better = true
    )
}
</code></pre></div></div>
<h1 id="one-logic-to-rule-them-all">One Logic to Rule Them All</h1>

<p>Notice that the above code creates a speedrun leaderboard for each level.  The logic for each leaderboard is very similar with the only difference being the <code class="language-plaintext highlighter-rouge">MapID()</code>.  The code takes advantage of this similarity and creates all the leaderboards by looping through each possible <code class="language-plaintext highlighter-rouge">MapID()</code>.  The <code class="language-plaintext highlighter-rouge">MapLookup[]</code> dictionary used to create the Rich Presence is also useful here to convert the <code class="language-plaintext highlighter-rouge">MapID()</code> to its name for the title and description of the leaderboard.</p>

<h2 id="start-event-1">Start Event</h2>
<p>The function <code class="language-plaintext highlighter-rouge">StartMap()</code> is used to prime the leaderboard.  The passed map id ensures that the leaderboard is only active on one map.  The event also checks that the player is on difficulty Hurt Me Plenty or higher, we are not on the result or intermission screen, and when the internal game timer steps from 0 to 2.</p>

<h2 id="cancel-event-1">Cancel Event</h2>
<p>The leaderboard will cancel if the loading screen is shown which means the player died or quit.  It will also cancel if any of the cheat codes were activated.  To ensure fairness leaderboards should be aware of in game cheats and either cancel or never get primed to begin with while a cheat is active.  In this case the cheats were put in the cancel event in case the player activates a cheat during the level.</p>

<h2 id="submit-event-1">Submit Event</h2>
<p>The leaderboard will submit when the results screen is shown for the current map.  The result screen is only shown when the player completes a map so it is a good event to use for the leaderboard submission.</p>

<h2 id="value">Value</h2>
<p>The value <code class="language-plaintext highlighter-rouge">always_true()</code> is used to count the number of frames that the leaderboard has been active for.  The <code class="language-plaintext highlighter-rouge">GameTimer()</code> memory value would have been a good candidate for the value as well however, unfortunately the timer is reset on the result screen so would always submit zero.</p>

<h2 id="lower-is-better-1">Lower is Better?</h2>
<p>In the case of speedruns leaderboard setting <code class="language-plaintext highlighter-rouge">lower_is_better = true</code> will mean that the leaderboard entries are sorted lowest to the highest with the player who completed the level in the least amount of time ranking the #1 spot.</p>

<h2 id="format-1">Format</h2>
<p>Since the value is counting the number of frames a level took to complete it is displayed to the screen and the site using <code class="language-plaintext highlighter-rouge">format="FRAMES"</code>.</p>

<h3 id="script">Script</h3>

<p>Script: <a href="https://github.com/Etron-RA/RetroAchievements/blob/main/Tutorials/12_Leaderboards/Example_12A.rascript">Example #12A script</a></p>

<h1 id="example-12b-kill-count">Example #12B: Kill Count</h1>
<p>Killing demons is not necessary to beating a level however, it does make it a lot easier to proceed through the map.  Each map in the Playstation set has three stacked achievements; one for beating the level, one for beating the level on Ultra-Violent (difficulty 4 of 4), and one for beating a map with 100% secrets and 100% kills.  As such the player will need to kill every demon on a map if they are going for a mastery of the game.  This leaderboard will track how many kills the player accumulates in one life for either Doom (maps 1-30) or Doom II (maps 31-54). <br /></p>

<p align="center">
  <img src="https://github.com/Etron-RA/RetroAchievements/blob/main/Tutorials/12_Leaderboards/Doom_Slayer.png?raw=true" />
</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>// Doom
// #ID = 11256

// $077E10: Map ID
function MapId() =&gt; byte(0x077E10)

// $077dc8: Results Screen
//          01 = Activated (Also at Main Menu)
function ResultScreen() =&gt; byte(0x077dc8)

// $07814C: Game Timer 32-bit
//          (Reset to 0 when the game load a level)
function GameTimer() =&gt; dword(0x07814C)

// $078258: Current Difficulty
function Difficulty() =&gt; byte(0x078258)

// $08656A: Loading...
//          10= On screen
function Loading() =&gt; byte(0x08656A)

// $086763: [8-bit] Password Screen (0x64 = on password screen)
function PasswordScreen() =&gt; byte(0x086763)

// $09874d: Intermission Screen Background
//          01 = Activated
function IntermissionScreen() =&gt; byte(0x09874d)

// $098740: Last HUD Text ID (16-bit)
//          10b0 = All powerful mode on
//          10e0= Lots of goodies!
//          52c= You got the BFG9000!  Oh, yes.
//          5bc= You got the shotgun!
//          5d4= You got the supershotgun!
//          54c= You got the chaingun!
//          564= A chainsaw! Find some meat!
//          584= You got the rocket launcher!
//          5a4= You got the plasma gun!
function LastHudText() =&gt; word(0x098740)

// $098744: HUD Text Timer in screen
function HudTextTimerInScreen() =&gt; byte(0x098744)

// $0A8810: Current Health (16bits)
function Health() =&gt; word(0x0A8810)

// $0A88AC: Cheats
//          Bit1= God Mode
//          Bit2= Full Map
//          Bit3= Show All Things on the Map
//          Bit5= Level Warping
//          Bit7= Invisible Walls
function Cheats() =&gt; byte(0x0A88AC)

// $0a88b4: Total Kills (32-bit)
//          Reset when a level is loaded
function TotalKills() =&gt; dword(0x0a88b4)

/// Helper Functions ////////////////////////////////////////////////////////////

// Start when mapid = current map, no intermission or load screen, 
// on Hurt me Plenty difficulty or higher, and the game timer has started
function StartMap(map)
{
    return MapId() == map &amp;&amp;
        Difficulty() &gt;= 2 &amp;&amp;
        ResultScreen() == 0 &amp;&amp;
        IntermissionScreen() == 0 &amp;&amp;
        prev(GameTimer()) == 0 &amp;&amp; 
        GameTimer() == 2
}

// End when mapid = current map and the results screen is shown
function EndMap(map)
{
    return MapId() == map &amp;&amp;
        prev(ResultScreen()) == 0 &amp;&amp; 
        ResultScreen() == 1
}

// Cancel when the loading screen appears, or any cheat are used
function GoodiesCheat() =&gt; HudTextTimerInScreen() == 1 &amp;&amp; LastHudText() == 0x0010e0
function CheatsBitflags() =&gt; Cheats() != 0

// Submit when main menu is open
function MainMenu() =&gt; MapId() == 0x0

// Cancel when entering a password
function PasswordEntry()
{
    return PasswordScreen() == 0x64 &amp;&amp; 
    prev(Loading()) != 0x10 &amp;&amp; 
    Loading() == 0x10
}

// Submit when player dies
function Death() =&gt; Health() == 0x0

// Submit when main menu is open
function MainMenu() =&gt; MapId() == 0x0

// Level name constants
firstDoom1Level = 0x1
firstDoom2Level = 0x1f 
lastDoom1Level = 0x1e 
lastDoom2Level = 0x36

// Created a kill array to track if multiple monsters were killed at once
function KillCounter(killMax)
{
    killArray = []
    for index in range(0,killMax)
    {
       array_push(killArray, prev(TotalKills()) + index &lt; TotalKills()) 
    }

    // Use the in-game timer for the time value
    return tally(2147483647, killArray)
}

/// Leaderboards ////////////////////////////////////////////////////////////
leaderboard
(
    "Ultimate Doom Slayer",
    "Most demons killed in one life starting from the first level of Ultimate Doom on Hurt Me Plenty or above",
    StartMap(firstDoom1Level),
    GoodiesCheat() || CheatsBitflags() || PasswordEntry(),
    Death() || MainMenu() || EndMap(lastDoom1Level),
    KillCounter(64),
    format = "VALUE",
    lower_is_better = false
)

leaderboard
(
    "Doom II Slayer",
    "Most demons killed in one life starting from the first level of Doom II on Hurt Me Plenty or above",
    StartMap(firstDoom2Level),
    GoodiesCheat() || CheatsBitflags() || PasswordEntry(),
    Death() || MainMenu() || EndMap(lastDoom2Level),
    KillCounter(64),
    format = "VALUE",
    lower_is_better = false
)
</code></pre></div></div>

<h2 id="counting-game-actions">Counting Game Actions</h2>
<p>These achievements uses the changes in the memory <code class="language-plaintext highlighter-rouge">TotalKills()</code> to count how many kills the player has accumulated. We could use the <code class="language-plaintext highlighter-rouge">TotalKills()</code> directly however, it is reset every level. So instead we count the total number of hits by how much the value <code class="language-plaintext highlighter-rouge">TotalKills()</code> changes each frame with the function <code class="language-plaintext highlighter-rouge">KillCounter()</code>.  We can get an accurate count of kills by making an array of delta checks that will add a hit if the kills has gone up by 1 or more, 2 or more, …, to <code class="language-plaintext highlighter-rouge">maxKills</code> or more each frame.   The value of <code class="language-plaintext highlighter-rouge">maxKills</code> can be set to any value but it should be high enough that it will account for the player killing multiple demons in the same frame with a large explosion.</p>

<h2 id="start-event-2">Start Event</h2>
<p>The function <code class="language-plaintext highlighter-rouge">StartMap()</code> is used to prime the leaderboard.  In this case we only want to start on map ID 0x1 for Doom or map ID 0x1f for Doom II.  The event also checks that the player is on difficulty Hurt Me Plenty or higher, we are not on the result or intermission screen, and when the internal game timer steps from 0 to 2.</p>

<h2 id="cancel-event-2">Cancel Event</h2>
<p>The leaderboard will cancel if the player enables any cheats or starts entering a password.</p>

<h2 id="submit-event-2">Submit Event</h2>
<p>The leaderboard will submit on death, exiting to the main menu, or by beating the last map ID 0x1e for Doom or map ID 0x36 for Doom II.</p>

<h2 id="value-1">Value</h2>
<p>The value submitted is a running count of the total kills using the <code class="language-plaintext highlighter-rouge">KillCounter()</code> function.</p>

<h2 id="lower-is-better-2">Lower is Better?</h2>
<p>In this case <code class="language-plaintext highlighter-rouge">lower_is_better = false</code> is used since we want to order the leaderboard from most kills to least kills.</p>

<h2 id="format-2">Format</h2>
<p>The format for these leaderboards is “VALUE” since we want to display the actual value of the number of monsters killed by the player.</p>

<h3 id="script-1">Script</h3>

<p>Script: <a href="https://github.com/Etron-RA/RetroAchievements/blob/main/Tutorials/12_Leaderboards/Example_12B.rascript">Example #12B script</a></p>

<h1 id="example-12c-game-speedruns">Example #12C: Game Speedruns</h1>
<p>While improving speeds on individual maps will improve your overall time the ultimate speedrun challenge is a full game play through.<br /></p>

<p align="center">
  <img src="https://github.com/Etron-RA/RetroAchievements/blob/main/Tutorials/12_Leaderboards/Doom_II_Level_1.png?raw=true" />
</p>

<h1 id="homework-12">Homework #12</h1>
<p>Create a leaderboard from the beginning map to the last map for both Doom and Doom II.</p>

<h2 id="useful-memory">Useful Memory</h2>
<p>You need to use the map ID at byte 0x077E10 to complete the homework. Here’s the values for all the maps:</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">ID</th>
      <th>Name</th>
      <th>Notes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">0x0</td>
      <td>Main Menu</td>
      <td>Show Map the title screen</td>
    </tr>
    <tr>
      <td style="text-align: center">0x1</td>
      <td>Hangar</td>
      <td>First Map of Doom</td>
    </tr>
    <tr>
      <td style="text-align: center">0x2</td>
      <td>Plant</td>
      <td> </td>
    </tr>
    <tr>
      <td style="text-align: center">0x3</td>
      <td>Toxin Refinery</td>
      <td> </td>
    </tr>
    <tr>
      <td style="text-align: center">0x4</td>
      <td>Command Control</td>
      <td> </td>
    </tr>
    <tr>
      <td style="text-align: center">0x5</td>
      <td>Phobos Lab</td>
      <td> </td>
    </tr>
    <tr>
      <td style="text-align: center">0x6</td>
      <td>Central Processing</td>
      <td> </td>
    </tr>
    <tr>
      <td style="text-align: center">0x7</td>
      <td>Computer Station</td>
      <td> </td>
    </tr>
    <tr>
      <td style="text-align: center">0x8</td>
      <td>Phobos Anomaly</td>
      <td> </td>
    </tr>
    <tr>
      <td style="text-align: center">0x9</td>
      <td>Deimos Anomaly</td>
      <td> </td>
    </tr>
    <tr>
      <td style="text-align: center">0xA</td>
      <td>Containment Area</td>
      <td> </td>
    </tr>
    <tr>
      <td style="text-align: center">0xB</td>
      <td>Refinery</td>
      <td> </td>
    </tr>
    <tr>
      <td style="text-align: center">0xC</td>
      <td>Deimos Lab</td>
      <td> </td>
    </tr>
    <tr>
      <td style="text-align: center">0xD</td>
      <td>Command Center</td>
      <td> </td>
    </tr>
    <tr>
      <td style="text-align: center">0xE</td>
      <td>Halls of the Damned</td>
      <td> </td>
    </tr>
    <tr>
      <td style="text-align: center">0xF</td>
      <td>Spawning Vats</td>
      <td> </td>
    </tr>
    <tr>
      <td style="text-align: center">0x10</td>
      <td>Hell Gate</td>
      <td> </td>
    </tr>
    <tr>
      <td style="text-align: center">0x11</td>
      <td>Hell Keep</td>
      <td> </td>
    </tr>
    <tr>
      <td style="text-align: center">0x12</td>
      <td>Pandemonium</td>
      <td> </td>
    </tr>
    <tr>
      <td style="text-align: center">0x13</td>
      <td>House of Pain</td>
      <td> </td>
    </tr>
    <tr>
      <td style="text-align: center">0x14</td>
      <td>Unholy Cathedral</td>
      <td> </td>
    </tr>
    <tr>
      <td style="text-align: center">0x15</td>
      <td>Mt. Erebus</td>
      <td> </td>
    </tr>
    <tr>
      <td style="text-align: center">0x16</td>
      <td>Limbo</td>
      <td> </td>
    </tr>
    <tr>
      <td style="text-align: center">0x17</td>
      <td>Tower of Babel</td>
      <td> </td>
    </tr>
    <tr>
      <td style="text-align: center">0x18</td>
      <td>Hell Beneath</td>
      <td> </td>
    </tr>
    <tr>
      <td style="text-align: center">0x19</td>
      <td>Perfect Hatred</td>
      <td> </td>
    </tr>
    <tr>
      <td style="text-align: center">0x1A</td>
      <td>Sever the Wicked</td>
      <td> </td>
    </tr>
    <tr>
      <td style="text-align: center">0x1B</td>
      <td>Unruly Evil</td>
      <td> </td>
    </tr>
    <tr>
      <td style="text-align: center">0x1C</td>
      <td>Unto the Cruel</td>
      <td> </td>
    </tr>
    <tr>
      <td style="text-align: center">0x1D</td>
      <td>Twilight Descends</td>
      <td> </td>
    </tr>
    <tr>
      <td style="text-align: center">0x1E</td>
      <td>Threshold of Pain</td>
      <td>Last Map of Doom</td>
    </tr>
    <tr>
      <td style="text-align: center">0x1F</td>
      <td>Entryway</td>
      <td>First Map of Doom II</td>
    </tr>
    <tr>
      <td style="text-align: center">0x20</td>
      <td>Underhalls</td>
      <td> </td>
    </tr>
    <tr>
      <td style="text-align: center">0x21</td>
      <td>The Gantlet</td>
      <td> </td>
    </tr>
    <tr>
      <td style="text-align: center">0x22</td>
      <td>The Focus</td>
      <td> </td>
    </tr>
    <tr>
      <td style="text-align: center">0x23</td>
      <td>The Waste Tunnels</td>
      <td> </td>
    </tr>
    <tr>
      <td style="text-align: center">0x24</td>
      <td>The Crusher</td>
      <td> </td>
    </tr>
    <tr>
      <td style="text-align: center">0x25</td>
      <td>Dead Simple</td>
      <td> </td>
    </tr>
    <tr>
      <td style="text-align: center">0x26</td>
      <td>Tricks and Traps</td>
      <td> </td>
    </tr>
    <tr>
      <td style="text-align: center">0x27</td>
      <td>The Pit</td>
      <td> </td>
    </tr>
    <tr>
      <td style="text-align: center">0x28</td>
      <td>Refueling Base</td>
      <td> </td>
    </tr>
    <tr>
      <td style="text-align: center">0x29</td>
      <td>O of Destruction!</td>
      <td> </td>
    </tr>
    <tr>
      <td style="text-align: center">0x2A</td>
      <td>The Factory</td>
      <td> </td>
    </tr>
    <tr>
      <td style="text-align: center">0x2B</td>
      <td>The Inmost Dens</td>
      <td> </td>
    </tr>
    <tr>
      <td style="text-align: center">0x2C</td>
      <td>Suburbs</td>
      <td> </td>
    </tr>
    <tr>
      <td style="text-align: center">0x2D</td>
      <td>Tenements</td>
      <td> </td>
    </tr>
    <tr>
      <td style="text-align: center">0x2E</td>
      <td>The Courtyard</td>
      <td> </td>
    </tr>
    <tr>
      <td style="text-align: center">0x2F</td>
      <td>The Citadel</td>
      <td> </td>
    </tr>
    <tr>
      <td style="text-align: center">0x30</td>
      <td>Nirvana</td>
      <td> </td>
    </tr>
    <tr>
      <td style="text-align: center">0x31</td>
      <td>The Catacombs</td>
      <td> </td>
    </tr>
    <tr>
      <td style="text-align: center">0x32</td>
      <td>Barrels of Fun</td>
      <td> </td>
    </tr>
    <tr>
      <td style="text-align: center">0x33</td>
      <td>Bloodfalls</td>
      <td> </td>
    </tr>
    <tr>
      <td style="text-align: center">0x34</td>
      <td>The Abandoned Mines</td>
      <td> </td>
    </tr>
    <tr>
      <td style="text-align: center">0x35</td>
      <td>Monster Condo</td>
      <td> </td>
    </tr>
    <tr>
      <td style="text-align: center">0x36</td>
      <td>Redemption Denied</td>
      <td>Last Map of Doom II</td>
    </tr>
    <tr>
      <td style="text-align: center">0x37</td>
      <td>Fortress of Mistery</td>
      <td>Bonus Map</td>
    </tr>
    <tr>
      <td style="text-align: center">0x38</td>
      <td>The Military Base</td>
      <td>Bonus Map</td>
    </tr>
    <tr>
      <td style="text-align: center">0x39</td>
      <td>The Marshes</td>
      <td>Bonus Map</td>
    </tr>
    <tr>
      <td style="text-align: center">0x3A</td>
      <td>The Mansion</td>
      <td>Bonus Map</td>
    </tr>
    <tr>
      <td style="text-align: center">0x3B</td>
      <td>Club Doom</td>
      <td>Bonus Map</td>
    </tr>
  </tbody>
</table>

<h3 id="solution">Solution</h3>

<p><a href="https://github.com/Etron-RA/RetroAchievements/blob/main/Tutorials/12_Leaderboards/Solution/readme.md">Tutorial #12 Solution</a><br /></p>

<hr />

<p><a href="../2022-02/rascript.html#tutorial-0---getting-started">Tutorial #0 - Getting Started</a><br />
<a href="../2022-02/rascript.html#tutorial-1---memory-basics">Tutorial #1 - Memory Basics</a><br />
<a href="../2022-03/rascript.html#tutorial-2---add-hits">Tutorial #2 - Add Hits</a><br />
<a href="../2022-04/rascript.html#tutorial-3---bit-flags">Tutorial #3 - Bit Flags</a><br />
<a href="../2022-05/rascript.html#tutorial-4---arithmetic-operations">Tutorial #4 - Arithmetic Operations</a><br />
<a href="../2022-06/rascript.html#tutorial-5---pointers">Tutorial #5 - Pointers</a><br />
<a href="../2022-07/rascript.html#tutorial-6--ifelse">Tutorial #6 - If/Else</a><br />
<a href="../2022-08/rascript.html#tutorial-7--challenges-part-1">Tutorial #7 - Challenges Part 1</a><br />
<a href="../2022-09/rascript.html#tutorial-8--challenges-part-2">Tutorial #8 - Challenges Part 2</a><br />
<a href="../2022-11/rascript.html#tutorial-9--trigger-and-measure-together">Tutorial #9 - Trigger and Measure Together</a><br />
<a href="../2022-12/rascript.html#tutorial-10--strings">Tutorial #10 - Strings</a><br />
<a href="../2023-03/rascript.html#tutorial-11--rich-presence">Tutorial #11 - Rich Presence</a></p>

<p>All RAScript Tutorials can be found <a href="https://github.com/Etron-RA/RetroAchievements/tree/main/Tutorials">here</a>.</p>


      </article>
      <footer>
        <nav>
  
    <a href="/issues/2023-05/rapodcast.html" class="previous">
      &#x00ab
      
        RAPodcast
      
    </a>
  
  
    <a href="/issues/2023-05/play-this-set.html" class="next">
      
        Play This Set
      
      &#x00bb
    </a>
  
</nav>
      </footer>
    </main>
  </div>

</body>

</html>